function nt(e){for(var t=e.split(/([#.])/),s="",i="",o=[],r=0;r<t.length;r++){var n=t[r];n==="#"?i=t[++r]:n==="."?o.push(t[++r]):n.length&&(s=n)}return{tag:s||"div",id:i,className:o.join(" ")}}function at(e,t){var s=nt(e),i=s.tag,o=s.id,r=s.className,n=t?document.createElementNS(t,i):document.createElement(i);return o&&(n.id=o),r&&(t?n.setAttribute("class",r):n.className=r),n}function W(e,t){var s=v(e),i=v(t);return t===i&&i.__redom_view&&(t=i.__redom_view),i.parentNode&&(q(t,i,s),s.removeChild(i)),t}function q(e,t,s){var i=t.__redom_lifecycle;if(H(i)){t.__redom_lifecycle={};return}var o=s;for(t.__redom_mounted&&C(t,"onunmount");o;){var r=o.__redom_lifecycle||{};for(var n in i)r[n]&&(r[n]-=i[n]);H(r)&&(o.__redom_lifecycle=null),o=o.parentNode}}function H(e){if(e==null)return!0;for(var t in e)if(e[t])return!1;return!0}var ht=["onmount","onremount","onunmount"],ct=typeof window!="undefined"&&"ShadowRoot"in window;function u(e,t,s,i){var o=v(e),r=v(t);t===r&&r.__redom_view&&(t=r.__redom_view),t!==r&&(r.__redom_view=t);var n=r.__redom_mounted,h=r.parentNode;return n&&h!==o&&q(t,r,h),s!=null?i?o.replaceChild(r,v(s)):o.insertBefore(r,v(s)):o.appendChild(r),lt(t,r,o,h),t}function C(e,t){t==="onmount"||t==="onremount"?e.__redom_mounted=!0:t==="onunmount"&&(e.__redom_mounted=!1);var s=e.__redom_lifecycle;if(!!s){var i=e.__redom_view,o=0;i&&i[t]&&i[t]();for(var r in s)r&&o++;if(o)for(var n=e.firstChild;n;){var h=n.nextSibling;C(n,t),n=h}}}function lt(e,t,s,i){for(var o=t.__redom_lifecycle||(t.__redom_lifecycle={}),r=s===i,n=!1,h=0,d=ht;h<d.length;h+=1){var f=d[h];r||e!==t&&f in e&&(o[f]=(o[f]||0)+1),o[f]&&(n=!0)}if(!n){t.__redom_lifecycle={};return}var c=s,w=!1;for((r||c&&c.__redom_mounted)&&(C(t,r?"onremount":"onmount"),w=!0);c;){var l=c.parentNode,_=c.__redom_lifecycle||(c.__redom_lifecycle={});for(var g in o)_[g]=(_[g]||0)+o[g];if(w)break;(c.nodeType===Node.DOCUMENT_NODE||ct&&c instanceof ShadowRoot||l&&l.__redom_mounted)&&(C(c,r?"onremount":"onmount"),w=!0),c=l}}function dt(e,t,s){var i=v(e);if(typeof t=="object")for(var o in t)z(i,o,t[o]);else z(i,t,s)}function z(e,t,s){s==null?e.style[t]="":e.style[t]=s}var F="http://www.w3.org/1999/xlink";function $(e,t,s,i){var o=v(e),r=typeof t=="object";if(r)for(var n in t)$(o,n,t[n],i);else{var h=o instanceof SVGElement,d=typeof s=="function";if(t==="style"&&typeof s=="object")dt(o,s);else if(h&&d)o[t]=s;else if(t==="dataset")K(o,s);else if(!h&&(t in o||d)&&t!=="list")o[t]=s;else{if(h&&t==="xlink"){G(o,s);return}i&&t==="class"&&(s=o.className+" "+s),s==null?o.removeAttribute(t):o.setAttribute(t,s)}}}function G(e,t,s){if(typeof t=="object")for(var i in t)G(e,i,t[i]);else s!=null?e.setAttributeNS(F,t,s):e.removeAttributeNS(F,t,s)}function K(e,t,s){if(typeof t=="object")for(var i in t)K(e,i,t[i]);else s!=null?e.dataset[t]=s:delete e.dataset[t]}function ut(e){return document.createTextNode(e??"")}function Q(e,t,s){for(var i=0,o=t;i<o.length;i+=1){var r=o[i];if(!(r!==0&&!r)){var n=typeof r;n==="function"?r(e):n==="string"||n==="number"?e.appendChild(ut(r)):E(v(r))?u(e,r):r.length?Q(e,r,s):n==="object"&&$(e,r,null,s)}}}function pt(e){return typeof e=="string"?x(e):v(e)}function v(e){return e.nodeType&&e||!e.el&&e||v(e.el)}function E(e){return e&&e.nodeType}var X={};function x(e){for(var t=[],s=arguments.length-1;s-- >0;)t[s]=arguments[s+1];var i,o=typeof e;if(o==="string")i=J(e).cloneNode(!1);else if(E(e))i=e.cloneNode(!1);else if(o==="function"){var r=e;i=new(Function.prototype.bind.apply(r,[null].concat(t)))}else throw new Error("At least one argument required");return Q(v(i),t,!0),i}var p=x;x.extend=function(t){for(var s=[],i=arguments.length-1;i-- >0;)s[i]=arguments[i+1];var o=J(t);return x.bind.apply(x,[this,o].concat(s))};function J(e){return X[e]||(X[e]=at(e))}function N(e){for(var t=[],s=arguments.length-1;s-- >0;)t[s]=arguments[s+1];for(var i=v(e),o=Y(e,t,i.firstChild);o;){var r=o.nextSibling;W(e,o),o=r}}function Y(e,t,s){for(var i=s,o=new Array(t.length),r=0;r<t.length;r++)o[r]=t[r]&&v(t[r]);for(var n=0;n<t.length;n++){var h=t[n];if(!!h){var d=o[n];if(d===i){i=i.nextSibling;continue}if(E(d)){var f=i&&i.nextSibling,c=h.__redom_index!=null,w=c&&f===o[n+1];u(e,h,i,w),w&&(i=f);continue}h.length!=null&&(i=Y(e,h,i))}}return i}var Z=function(t,s,i){this.View=t,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],s!=null&&(this.key=typeof s=="function"?s:mt(s))};Z.prototype.update=function(t,s){for(var i=this,o=i.View,r=i.key,n=i.initData,h=r!=null,d=this.lookup,f={},c=new Array(t.length),w=this.views,l=0;l<t.length;l++){var _=t[l],g=void 0;if(h){var R=r(_);g=d[R]||new o(n,_,l,t),f[R]=g,g.__redom_id=R}else g=w[l]||new o(n,_,l,t);g.update&&g.update(_,l,t,s);var rt=v(g.el);rt.__redom_view=g,c[l]=g}this.oldViews=w,this.views=c,this.oldLookup=d,this.lookup=f};function mt(e){return function(t){return t[e]}}var k=function(t,s,i,o){this.View=s,this.initData=o,this.views=[],this.pool=new Z(s,i,o),this.el=pt(t),this.keySet=i!=null};k.prototype.update=function(t,s){t===void 0&&(t=[]);var i=this,o=i.keySet,r=this.views;this.pool.update(t,s);var n=this.pool,h=n.views,d=n.lookup;if(o)for(var f=0;f<r.length;f++){var c=r[f],w=c.__redom_id;d[w]==null&&(c.__redom_index=null,W(this,c))}for(var l=0;l<h.length;l++){var _=h[l];_.__redom_index=l}N(this,h),o&&(this.lookup=d),this.views=h};k.extend=function(t,s,i,o){return k.bind(k,t,s,i,o)};var a;(function(e){e[e.noDevice=0]="noDevice",e[e.requestingDevice=1]="requestingDevice",e[e.idle=2]="idle",e[e.starting=3]="starting",e[e.ready=4]="ready",e[e.recording=5]="recording",e[e.closing=6]="closing",e[e.error=7]="error"})(a||(a={}));var tt;(function(e){e[e.idle=0]="idle",e[e.start=1]="start",e[e.holding=2]="holding"})(tt||(tt={}));var S=class{constructor(t,s,i){if(this.handler=t,this.stateLabels=s,!(i in this.stateLabels))throw Error("Initial state not available state");this.state=i,this.touchTimeout=0,this.touchState=0,this.touchHold=this.touchHold.bind(this),this.el=p("button",this.stateLabels[i]),this.onDown=this.onDown.bind(this),this.el.addEventListener("mousedown",this.onDown),this.touchStart=this.touchStart.bind(this),this.el.addEventListener("touchstart",this.touchStart),this.touchEnd=this.touchEnd.bind(this),this.el.addEventListener("touchend",this.touchEnd),this.onUp=this.onUp.bind(this),this.el.addEventListener("mouseup",this.onUp),this.onClick=this.onClick.bind(this),this.el.addEventListener("click",this.onClick),this.onLeave=this.onLeave.bind(this),this.el.addEventListener("mouseleave",this.onLeave)}touchEnd(t){t.preventDefault(),t.stopPropagation(),clearTimeout(this.touchTimeout),this.touchState===2?(this.touchState=0,this.onUp()):(this.touchState=0,this.onClick())}touchHold(){this.touchState=2,this.onDown()}touchStart(t){t.preventDefault(),t.stopPropagation(),this.touchState===0&&(this.touchState=1,this.touchTimeout=window.setTimeout(this.touchHold,100))}onUp(t){t?.preventDefault(),this.handler.onUp?.(this.state)}onClick(t){t?.preventDefault(),this.handler.onClick?.(this.state)}onDown(t){t?.preventDefault(),this.handler.onDown?.(this.state)}onLeave(t){t?.preventDefault(),this.handler.onLeave?.(this.state)}setState(t){if(!(t in this.stateLabels))throw Error("Setting unavailable button state");this.state=t,this.el.textContent=this.stateLabels[this.state]}enable(){this.el.disabled=!1}disable(){this.el.disabled=!0}};var m;(function(e){e.error="Reload context",e.noDevice="Enable input device",e.requestingDevice="Loading...",e.idle="Hold down to record",e.stopRecording="Stopping...",e.recording="Release to stop recording",e.startRecording="Starting..."})(m||(m={}));var D=class{constructor(t,s,i){this.id=t,this.handler=s,this.recordLength=i,this.el=new S(this,Object.values(m).reduce((o,r)=>Object.assign(o,{[r]:r}),{}),m.noDevice),this.isRecordingEntity=!0,this.stopRecording=this.stopRecording.bind(this),this.onDown=this.onDown.bind(this),this.onUp=this.onUp.bind(this),this.onLeave=this.onLeave.bind(this),this.onClick=this.onClick.bind(this),this.recordingTimeout=0}stopRecording(){clearTimeout(this.recordingTimeout),this.handler.recordButtonOnStop()}onDown(t){t===m.idle&&this.handler.recordButtonOnStart()}onUp(t){t===m.recording&&this.stopRecording()}onLeave(t){t===m.recording&&this.stopRecording()}onClick(t){switch(t){case m.error:this.handler.recordButtonOnReload();break;case m.noDevice:this.handler.recordButtonOnRequest();break;default:break}}onRecordingStateChanged(t){switch(t){case a.starting:this.el.disable(),this.el.setState(m.startRecording);break;case a.recording:this.el.setState(m.recording),this.el.enable(),this.recordingTimeout=window.setTimeout(this.stopRecording,this.recordLength*1e3);break;case a.closing:this.el.disable(),this.el.setState(m.stopRecording);break;case a.idle:this.el.setState(m.idle),this.el.enable();break;case a.noDevice:this.el.setState(m.noDevice);break;case a.error:this.el.setState(m.error);break;case a.requestingDevice:this.el.disable(),this.el.setState(m.requestingDevice);break}}onRecordingError(){this.el.setState(m.error)}};var et={MODE:"production",NODE_ENV:"production",SSR:!1};import.meta.env=et;var L=class{constructor(t,s,i,o){this.core=t,this.workerPath=s,this.chunkSize=i,this.recordLength=o,this.mediaTracks=[],this.state=a.noDevice,this.handleRecorderMessage=this.handleRecorderMessage.bind(this),this.core.context.audioWorklet?this.core.context.audioWorklet.addModule(this.workerPath).catch(r=>this.emit("error",void 0,r)):(this.recorderNode=this.core.context.createScriptProcessor(this.chunkSize,1,1),this.processChunk=this.processChunk.bind(this),this.recorderNode.addEventListener("audioprocess",this.processChunk),this.recorderNode.connect(this.core.context.destination))}setRecorder(){if(this.core.context.audioWorklet){if(this.recorderNode=new AudioWorkletNode(this.core.context,"recording-worklet",{numberOfOutputs:0,numberOfInputs:1}),!this.recorderNode)throw Error("No recording node available to connect");this.core.getRecorderInputNode().connect(this.recorderNode),this.recorder=this.recorderNode.port}else this.recorder=new Worker(new URL(this.workerPath,import.meta.url),{name:"recording-worker",type:"module"});this.recorder.onmessage=this.handleRecorderMessage,this.postRecorder({command:"init",data:{chunkSize:this.chunkSize,maxLength:this.recordLength,sampleRate:this.core.context.sampleRate}})}unsetRecorder(){if(this.core.context.audioWorklet){if(!this.recorderNode)throw Error("No recording node available to disconnect");this.core.getRecorderInputNode().disconnect(this.recorderNode)}this.recorder=void 0}handleRecorderMessage(t){switch(t.data.message){case"ready":this.emit("state",a.ready);break;case"recording":this.emit("state",a.recording);break;case"done":this.unsetRecorder(),this.emit("state",a.idle),this.core.onRecorded(t.data.buffer);break}}processChunk(t){this.postRecorder({command:"chunk",buffer:t.inputBuffer.getChannelData(0)})}isRecordingEntity(t){return"isRecordingEntity"in t&&t.isRecordingEntity}postRecorder(t){this.recorder?.postMessage(t)}shiftState(t){if(t===this.state)return!1;switch(t){case a.closing:return this.state!==a.recording?!1:(this.state=a.closing,this.postRecorder({command:"stop"}),!0);case a.error:return this.state=a.error,!0;case a.idle:return this.state!==a.closing&&this.state!==a.requestingDevice?!1:(this.state=a.idle,!0);case a.noDevice:return this.state!==a.error?!1:(this.state=a.noDevice,!0);case a.recording:return this.state!==a.ready?!1:(this.state=a.recording,!0);case a.requestingDevice:return this.state!==a.noDevice?!1:(this.state=a.requestingDevice,this.getCapture(),!0);case a.ready:return this.state!==a.starting?!1:(this.state=a.ready,this.postRecorder({command:"start"}),!0);case a.starting:return this.state!==a.idle?!1:(this.state=a.starting,this.setRecorder(),!0)}}emit(t,s,i){if(!(t==="state"&&s&&!this.shiftState(s)))for(let o=0;o<this.core.entities.length;o++){let r=this.core.entities[o];this.isRecordingEntity(r)&&(t==="state"&&s?r.onRecordingStateChanged(s):t==="error"&&i&&r.onRecordingError(i))}}getCapture(){navigator.mediaDevices.getUserMedia({audio:{autoGainControl:!1,echoCancellation:!1,noiseSuppression:!1},video:!1}).then(t=>(this.mediaTracks.push(...t.getAudioTracks()),this.core.handleStream(t))).then(()=>this.emit("state",a.idle)).catch(t=>this.emit("error",void 0,t))}recordButtonOnStart(){this.emit("state",a.starting)}recordButtonOnStop(){this.emit("state",a.closing)}recordButtonOnReload(){for(let t=0;t<this.mediaTracks.length;t++)this.mediaTracks[t].stop();this.mediaTracks.length=0,this.emit("state",a.noDevice)}recordButtonOnRequest(){this.emit("state",a.requestingDevice)}};var st;(function(e){e[e.notStarted=0]="notStarted",e[e.paused=1]="paused",e[e.playing=2]="playing"})(st||(st={}));var T=class{constructor(t,s){this.core=t,this.channels=s,this.samples=[]}create(t){if(t.length<this.core.context.sampleRate*.2)return;let s=this.core.context.createBuffer(this.channels,t.length,this.core.context.sampleRate),i=this.core.context.createBufferSource();s.copyToChannel(t,0),i.buffer=s,i.loop=!0;let o=this.samples.length;this.samples.push({label:`Sample ${new Date().toUTCString()}`,node:i,state:0}),this.core.onSampleAdd(o)}play(t){if(this.samples[t].state===2)return;let s=this.samples[t].state===0;this.samples[t].state=2,s&&this.samples[t].node.start()}pause(t){this.samples[t].state!==1&&(this.samples[t].state=1)}setLabel(t,s){this.samples[t].label=s,this.core.onLabelChange(t)}setPlaybackSpeed(t,s){this.samples[t].node.playbackRate.linearRampToValueAtTime(s,this.core.context.currentTime+10)}node(t){return this.samples[t].node}label(t){return this.samples[t].label}};var I=class{constructor(t){this.handler=t,this.el=p("div.sampleSelect"),this.handleClick=this.handleClick.bind(this),this.elements=[],this.selectedIndex=-1}handleClick(t){t!==this.selectedIndex&&(this.selectedIndex>-1&&this.elements[this.selectedIndex].classList.remove("selected"),this.elements[t].classList.add("selected"),this.handler.onSampleSelected(t,this.selectedIndex>-1?this.selectedIndex:void 0),this.selectedIndex=t)}add(t,s){let i=p("div.sampleItem",s);i.addEventListener("click",o=>{o.preventDefault(),this.handleClick(t)}),this.elements.push(i),u(this.el,i)}};var O=class{constructor(t,s,i){this.id=t,this.inputNode=s,this.outputNode=i,this.isExt=!0}isExtension(t){return"isExt"in t&&t.isExt}setInput(t){if(this.inputNode)throw Error(`Input node already set for ${this.id}`);this.inputNode=t}setOutput(t){if(this.outputNode)throw Error(`Output node already set for ${this.id}`);this.outputNode=t}input(){if(!this.inputNode)throw Error(`No input node set for ${this.id}`);return this.inputNode}output(){if(!this.outputNode)throw Error(`No output node set for ${this.id}`);return this.outputNode}connectInput(t){this.isExtension(t)?t.output().connect(this.input()):t.connect(this.input())}disconnectInput(t){this.isExtension(t)?t.output().disconnect(this.input()):t.disconnect(this.input())}connectOutput(t){this.isExtension(t)?this.output().connect(t.input()):this.output().connect(t)}disconnectOutput(t){this.isExtension(t)?this.output().disconnect(t.input()):this.output().disconnect(t)}};var b=class extends O{constructor(t,s,i="min"){super(t);this.core=s;let o=typeof i=="number"?i:i==="max"?101:i==="mid"?51:1;this.el=p("input",{type:"range",value:o,min:1,max:101,step:1e-4}),this.debounceOnChange=this.debounceOnChange.bind(this),this.el.addEventListener("input",this.debounceOnChange),this.debounce=0,this.debounceCount=0}logRange(t,s,i,o){if(i<=s)return s;let r=1,n=101,h=s<0&&i<0,d=h?s*-1+1:s<=0?-1*s+1:s+1,f=h?i*-1+1:s<=0?i+d:i+1,c=Math.log(d),l=(Math.log(f)-c)/(n-r);return o?(Math.log(t/(h?-1:1)+(h||s>0?1:d))-c)/l+r:(Math.exp(c+l*(t-r))-(h||s>0?1:d))*(h?-1:1)}debounceOnChange(){this.debounceCount+=1,clearTimeout(this.debounce),this.debounceCount>=50&&(this.debounceCount=0,this.onChange(parseFloat(this.el.value))),this.debounce=window.setTimeout(()=>this.onChange(parseFloat(this.el.value)),30)}onChange(t){throw Error(`Override on change, output value is ${t}`)}ramp(t,s){t.linearRampToValueAtTime(s,this.core.context.currentTime+.5)}};var j=class extends b{constructor(t){super("Compressor",t);this.gain=this.core.context.createGain(),this.node=this.core.context.createDynamicsCompressor(),this.gain.connect(this.node),this.setInput(this.gain),this.setOutput(this.node),this.gain.gain.setValueAtTime(-1,this.core.context.currentTime),this.node.threshold.setValueAtTime(-10,this.core.context.currentTime),this.node.knee.setValueAtTime(4,this.core.context.currentTime),this.node.ratio.setValueAtTime(2,this.core.context.currentTime),this.node.attack.setValueAtTime(0,this.core.context.currentTime),this.node.release.setValueAtTime(.1,this.core.context.currentTime)}onChange(t){this.ramp(this.gain.gain,this.logRange(t,-1,-1)),this.ramp(this.node.threshold,0-this.logRange(t,10,100)),this.ramp(this.node.knee,this.logRange(t,4,40)),this.ramp(this.node.ratio,this.logRange(t,2,20)),this.ramp(this.node.release,Math.pow(20,-1*this.logRange(t,1,1e3)))}};var A=class extends b{constructor(t){super("Distortion",t);this.node=this.core.context.createWaveShaper(),this.setInput(this.node),this.setOutput(this.node),this.node.oversample="4x",this.curveData=new Float32Array(this.core.context.sampleRate),this.curve(0),this.node.curve=this.curveData}curve(t){let s=typeof t=="number"?t:50,i=Math.PI/180,o=0;for(let r=0;r<this.core.context.sampleRate;++r)o=r*2/this.core.context.sampleRate-1,this.curveData[r]=(10+s)*o*50*i/(Math.PI+s*Math.abs(o))}onChange(t){this.curve(~~this.logRange(t,0,1e4)),this.node.curve=this.curveData}};var B=class extends b{constructor(t){super("Lowpass",t);this.node=this.core.context.createBiquadFilter(),this.setInput(this.node),this.setOutput(this.node),this.node.frequency.value=6e3,this.node.type="lowpass"}onChange(t){this.ramp(this.node.frequency,6e3-this.logRange(t,0,5950*.005)*200)}};var it;(function(e){e[e.playing=0]="playing",e[e.paused=1]="paused"})(it||(it={}));var M=class{constructor(t){this.handler=t,this.el=p("button","Play audio"),this.state=1,this.playBtnEvent=this.playBtnEvent.bind(this),this.el.addEventListener("click",this.playBtnEvent)}playBtnEvent(){switch(this.state){case 1:this.state=0,this.el.textContent="Pause audio",this.handler.onPlay();break;case 0:this.pause();break}}pause(){this.state!==1&&(this.state=1,this.el.textContent="Play audio",this.handler.onPause())}};var U=class extends b{constructor(t,s){super("Speed",t);this.node=s,this.setInput(this.node),this.setOutput(this.node),this.el.value=`${this.logRange(1,.1,3,!0)}`}onChange(t){this.ramp(this.node.playbackRate,this.logRange(t,.1,3))}};var P=class extends b{constructor(t){super("Volume",t,"mid");this.node=this.core.context.createGain(),this.setInput(this.node),this.setOutput(this.node),this.node.gain.setValueAtTime(this.logRange(51,0,3),this.core.context.currentTime)}onChange(t){this.ramp(this.node.gain,this.logRange(t,0,3))}};var ot;(function(e){e[e.visible=0]="visible",e[e.hidden=1]="hidden"})(ot||(ot={}));var V=class{constructor(t,s,i){this.core=t,this.bufferNode=s,this.nodeIndex=i,this.el=p("div.hidden"),this.playBtn=new M(this),this.volumeCtrl=new P(this.core),this.volumeCtrl.connectOutput(this.core.context.destination),this.lowpassCtrl=new B(this.core),this.lowpassCtrl.connectOutput(this.volumeCtrl),this.distortionCtrl=new A(this.core),this.distortionCtrl.connectOutput(this.lowpassCtrl),this.compressorCtrl=new j(this.core),this.compressorCtrl.connectOutput(this.distortionCtrl),this.speedCtrl=new U(this.core,this.bufferNode),u(this.el,this.wrap(this.playBtn)),u(this.el,this.wrap(this.compressorCtrl,"Slide to control compressor")),u(this.el,this.wrap(this.distortionCtrl,"Slide to control distortion")),u(this.el,this.wrap(this.lowpassCtrl,"Slide to control filter")),u(this.el,this.wrap(this.volumeCtrl,"Slide to control volume")),u(this.el,this.wrap(this.speedCtrl,"Slide to control speed")),this.state=1}wrap(t,s){let i=p("div");if(s){let o=p("p",s);u(i,o)}return u(i,t),i}show(){this.state!==0&&(this.state=0,this.el.classList.remove("hidden"))}hide(){this.state!==1&&(this.state=1,this.el.classList.add("hidden"))}async onPlay(){this.compressorCtrl.connectInput(this.bufferNode),this.core.onPlaySample(this.nodeIndex)}async onPause(){this.compressorCtrl.disconnectInput(this.bufferNode),this.core.onPauseSample(this.nodeIndex)}};var y=class{static init(){new y}constructor(){this.baseEl=this.getElOrThrow("#root");let t=window.AudioContext||window.webkitAudioContext;this.context=new t,this.context.suspend();let s=10,i=4096;this.entities=[],this.recordingHandler=new L(this,"/_dist_/recordingWorker.js",i,s),this.recordBtn=new D(`${this.entities.length}`,this.recordingHandler,s),this.entities.push(this.recordBtn),this.sampleBank=new T(this,1),this.sampleBlocks=[],this.samplesMount=p("div.samplesMount"),this.sampleList=new I(this),this.setUI()}getElOrThrow(t){let s=document.querySelector(t);if(!s)throw Error(`Couldn't find element ${t}`);return s}wrap(t,s,i){let o=p(`div${i?`.${i}`:""}`);if(s){let r=p("p",s);u(o,r)}return Array.isArray(t)?N(o,t):u(o,t),o}setUI(){u(this.baseEl,this.wrap([this.wrap(this.recordBtn),this.samplesMount],void 0,"controls")),u(this.baseEl,this.sampleList)}onRecorded(t){this.sampleBank.create(t)}async handleStream(t){this.context.resume(),this.sourceNode=this.context.createMediaStreamSource(t)}onError(){this.context.suspend()}async startRecording(){}async stopRecording(){}async reloadContext(){this.context.resume()}async onPlaySample(t){this.sampleBank.play(t)}async onPauseSample(t){this.sampleBank.pause(t)}onSampleAdd(t){let s=new V(this,this.sampleBank.node(t),t);this.sampleBlocks.push(s),u(this.samplesMount,s),this.sampleList.add(t,this.sampleBank.label(t))}onLabelChange(){}onSampleSelected(t,s){s!==void 0&&this.sampleBlocks[s].hide(),this.sampleBlocks[t].show()}getRecorderInputNode(){if(!this.sourceNode)throw Error("No source node available for recording");return this.sourceNode}};export{y as Schallvernichtung};
