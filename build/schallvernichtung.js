var F={MODE:"production",NODE_ENV:"production",SSR:!1};var h;(function(s){s[s.noDevice=0]="noDevice",s[s.requestingDevice=1]="requestingDevice",s[s.idle=2]="idle",s[s.starting=3]="starting",s[s.ready=4]="ready",s[s.recording=5]="recording",s[s.closing=6]="closing",s[s.error=7]="error"})(h||(h={}));import.meta.env=F;var Z=class{constructor(t,e,i,o,n){this.core=t,this.audio=e,this.workerPath=i,this.chunkSize=o,this.recordLength=n,this.mediaTracks=[],this.state=h.noDevice,this.handleRecorderMessage=this.handleRecorderMessage.bind(this),this.audio.context().audioWorklet?this.audio.context().audioWorklet.addModule(this.workerPath).catch(r=>this.emit("error",void 0,r)):(this.recorderNode=this.audio.context().createScriptProcessor(this.chunkSize,1,1),this.processChunk=this.processChunk.bind(this),this.recorderNode.addEventListener("audioprocess",this.processChunk),this.recorderNode.connect(this.audio.context().destination))}setRecorder(){if(this.audio.context().audioWorklet){if(this.recorderNode=new AudioWorkletNode(this.audio.context(),"recording-worklet",{numberOfOutputs:0,numberOfInputs:1}),!this.recorderNode)throw Error("No recording node available to connect");this.audio.getRecorderNode().audioNodeManager.connectOutput(this.recorderNode),this.recorder=this.recorderNode.port}else this.recorder=new Worker(new URL(this.workerPath,import.meta.url),{name:"recording-worker",type:"module"});this.recorder.onmessage=this.handleRecorderMessage,this.postRecorder({command:"init",data:{chunkSize:this.chunkSize,maxLength:this.recordLength,sampleRate:this.audio.context().sampleRate}})}unsetRecorder(){if(this.audio.context().audioWorklet){if(!this.recorderNode)throw Error("No recording node available to disconnect");this.audio.getRecorderNode().audioNodeManager.disconnectOutput(this.recorderNode)}this.recorder=void 0}handleRecorderMessage(t){switch(t.data.message){case"ready":this.emit("state",h.ready);break;case"recording":this.emit("state",h.recording);break;case"done":this.unsetRecorder(),this.emit("state",h.idle),this.core.onRecorded(t.data.buffer);break}}processChunk(t){this.postRecorder({command:"chunk",buffer:t.inputBuffer.getChannelData(0)})}isRecordingEntity(t){return"isRecordingEntity"in t&&t.isRecordingEntity}postRecorder(t){this.recorder?.postMessage(t)}shiftState(t){if(t===this.state)return!1;switch(t){case h.closing:return this.state!==h.recording?!1:(this.state=h.closing,this.postRecorder({command:"stop"}),!0);case h.error:return this.state=h.error,!0;case h.idle:return this.state!==h.closing&&this.state!==h.requestingDevice?!1:(this.state=h.idle,!0);case h.noDevice:return this.state!==h.error?!1:(this.state=h.noDevice,!0);case h.recording:return this.state!==h.ready?!1:(this.state=h.recording,!0);case h.requestingDevice:return this.state!==h.noDevice?!1:(this.state=h.requestingDevice,this.getCapture(),!0);case h.ready:return this.state!==h.starting?!1:(this.state=h.ready,this.postRecorder({command:"start"}),!0);case h.starting:return this.state!==h.idle?!1:(this.state=h.starting,this.setRecorder(),!0)}}emit(t,e,i){if(!(t==="state"&&e!==void 0&&!this.shiftState(e)))for(let o=0;o<this.core.entities().length;o++){let n=this.core.entities()[o];this.isRecordingEntity(n)&&(t==="state"&&e?n.onRecordingStateChanged(e):t==="error"&&i&&n.onRecordingError(i))}}getCapture(){navigator.mediaDevices.getUserMedia({audio:{autoGainControl:!1,echoCancellation:!1,noiseSuppression:!1},video:!1}).then(t=>(this.mediaTracks.push(...t.getAudioTracks()),this.audio.handleStream(t))).then(()=>this.emit("state",h.idle)).catch(t=>this.emit("error",void 0,t))}recordButtonOnStart(){this.emit("state",h.starting)}recordButtonOnStop(){this.emit("state",h.closing)}recordButtonOnReload(){for(let t=0;t<this.mediaTracks.length;t++)this.mediaTracks[t].stop();this.mediaTracks.length=0,this.emit("state",h.noDevice)}recordButtonOnRequest(){this.emit("state",h.requestingDevice)}};var q=(s=21)=>{let t="",e=crypto.getRandomValues(new Uint8Array(s));for(;s--;){let i=e[s]&63;i<36?t+=i.toString(36):i<62?t+=(i-26).toString(36).toUpperCase():i<63?t+="_":t+="-"}return t};var g;(function(s){s[s.notStarted=0]="notStarted",s[s.playing=1]="playing",s[s.paused=2]="paused"})(g||(g={}));var A;(function(s){s.distortion="distortion",s.compressor="compressor",s.volume="volume",s.lowpass="lowpass",s.speed="speed"})(A||(A={}));var V=class{constructor(t){this.core=t,this.state={}}isSampleEntity(t){return"isSampleEntity"in t&&t.isSampleEntity}emit(t){for(let e=0;e<this.core.entities().length;e++){let i=this.core.entities()[e];this.isSampleEntity(i)&&t(i)}}onSampleSelected(t){this.emit(e=>e.onSampleSelectedChanged(t))}onSampleControlChange(t,e,i){this.emit(o=>o.onSampleNodeValueChange(t,e,i))}onToggleSamplePlaying(t){let e=this.state[t];this.state[t]=this.state[t]===g.notStarted||this.state[t]===g.paused?g.playing:g.paused,this.emit(i=>i.onSampleStateChanged(t,this.state[t],e))}onSampleCreated(t){this.state[t]=g.notStarted,this.emit(e=>e.onSampleCreated(t))}};var x=class{constructor(t,e,i){this.id=t,this.inputNode=e,this.outputNode=i,this.inputConnections={},this.outputConnections={}}isManaged(t){return"isAudioNodeManaged"in t&&t.isAudioNodeManaged&&t.audioNodeManager!==void 0}nodeID(){return this.id}setInput(t){if(this.inputNode)throw Error(`Input node already set for ${this.id}`);this.inputNode=t}setOutput(t){if(this.outputNode)throw Error(`Output node already set for ${this.id}`);this.outputNode=t}input(){if(!this.inputNode)throw Error(`No input node set for ${this.id}`);return this.inputNode}output(){if(!this.outputNode)throw Error(`No output node set for ${this.id}`);return this.outputNode}connectInput(t){if(this.isManaged(t)){if(this.inputConnections[t.audioNodeManager.nodeID()])return;t.audioNodeManager.output().connect(this.input()),this.inputConnections[t.audioNodeManager.nodeID()]=t}else t.connect(this.input())}disconnectInput(t){if(this.isManaged(t)){if(this.inputConnections[t.audioNodeManager.nodeID()])return this.disconnectInputByID(t.audioNodeManager.nodeID());t.audioNodeManager.output().disconnect(this.input())}else t.disconnect(this.input())}disconnectInputByID(t){if(this.inputConnections[t]){let e=this.inputConnections[t];delete this.inputConnections[t],this.disconnectInput(e)}}connectOutput(t){if(this.isManaged(t)){if(this.outputConnections[t.audioNodeManager.nodeID()])return;this.output().connect(t.audioNodeManager.input()),this.outputConnections[t.audioNodeManager.nodeID()]=t}else this.output().connect(t)}disconnectOutput(t){if(this.isManaged(t)){if(this.outputConnections[t.audioNodeManager.nodeID()])return this.disconnectOutputByID(t.audioNodeManager.nodeID());this.output().disconnect(t.audioNodeManager.input())}else this.output().disconnect(t)}disconnectOutputByID(t){if(this.outputConnections[t]){let e=this.outputConnections[t];delete this.outputConnections[t],this.disconnectOutput(e)}}};var k=class{constructor(t,e,i,o){this.id=t,this.core=e,this.math=i,this.audioNodeManager=new x(t),this.isAudioNodeManaged=!0,this.isSampleEntity=!0;let n=this.core.context().createBuffer(1,o.length,this.core.context().sampleRate);this.bufferNode=this.core.context().createBufferSource(),n.copyToChannel(o,0),this.bufferNode.buffer=n,this.bufferNode.loop=!0,this.volumeNode=this.core.context().createGain(),this.volumeNode.gain.setValueAtTime(this.math.exponentialValueInRange(500001,0,3),this.core.context().currentTime),this.audioNodeManager.setOutput(this.volumeNode),this.lowpassFilterNode=this.core.context().createBiquadFilter(),this.lowpassFilterNode.frequency.value=6e3,this.lowpassFilterNode.type="lowpass",this.lowpassFilterNode.connect(this.volumeNode),this.distortionFilterNode=this.core.context().createWaveShaper(),this.distortionFilterNode.oversample="4x",this.distortionCurveData=new Float32Array(this.core.context().sampleRate),this.curve(0),this.distortionFilterNode.curve=this.distortionCurveData,this.distortionFilterNode.connect(this.lowpassFilterNode),this.compressorGainNode=this.core.context().createGain(),this.compressorGainNode.gain.setValueAtTime(-1,this.core.context().currentTime),this.compressorFilterNode=this.core.context().createDynamicsCompressor(),this.compressorGainNode.connect(this.compressorFilterNode),this.compressorFilterNode.threshold.setValueAtTime(-10,this.core.context().currentTime),this.compressorFilterNode.knee.setValueAtTime(4,this.core.context().currentTime),this.compressorFilterNode.ratio.setValueAtTime(2,this.core.context().currentTime),this.compressorFilterNode.attack.setValueAtTime(0,this.core.context().currentTime),this.compressorFilterNode.release.setValueAtTime(.1,this.core.context().currentTime),this.compressorFilterNode.connect(this.distortionFilterNode)}curve(t){let e=typeof t=="number"?~~t:50,i=Math.PI/180,o=0;for(let n=0;n<this.core.context().sampleRate;++n)o=n*2/this.core.context().sampleRate-1,this.distortionCurveData[n]=(10+e)*o*50*i/(Math.PI+e*Math.abs(o))}ramp(t,e,i){t.linearRampToValueAtTime(e,i)}rampTime(){return this.core.context().currentTime+.5}setCompressor(t){this.ramp(this.compressorGainNode.gain,this.math.exponentialValueInRange(t,-1,-1),this.rampTime()),this.ramp(this.compressorFilterNode.threshold,0-this.math.exponentialValueInRange(t,10,100),this.rampTime()),this.ramp(this.compressorFilterNode.knee,this.math.exponentialValueInRange(t,4,40),this.rampTime()),this.ramp(this.compressorFilterNode.ratio,this.math.exponentialValueInRange(t,2,20),this.rampTime()),this.ramp(this.compressorFilterNode.release,Math.pow(20,-1*this.math.exponentialValueInRange(t,1,1e3)),this.rampTime())}setDistortion(t){this.curve(this.math.exponentialValueInRange(t,0,1e4)),this.distortionFilterNode.curve=this.distortionCurveData}setLowpass(t){this.ramp(this.lowpassFilterNode.frequency,6e3-this.math.exponentialValueInRange(t,0,5950*.005)*200,this.rampTime())}setSpeed(t){this.ramp(this.bufferNode.playbackRate,this.math.exponentialValueInRange(t,.1,3),this.rampTime())}setVolume(t){this.ramp(this.volumeNode.gain,this.math.exponentialValueInRange(t,0,3),this.rampTime())}onSampleStateChanged(t,e,i){if(t===this.id)switch(e){case g.playing:i===g.notStarted&&this.bufferNode.start(),this.bufferNode.connect(this.compressorGainNode);break;case g.paused:this.bufferNode.disconnect(this.compressorGainNode);break}}onSampleError(t){}onSampleNodeValueChange(t,e,i){if(t===this.id)switch(e){case A.compressor:this.setCompressor(i);break;case A.distortion:this.setDistortion(i);break;case A.lowpass:this.setLowpass(i);break;case A.speed:this.setSpeed(i);break;case A.volume:this.setVolume(i);break}}onSampleSelectedChanged(){}onSampleCreated(){}};var B=class{constructor(t){let e=window.AudioContext||window.webkitAudioContext;this._context=new e,this._context.suspend(),this.isAudioNodeManaged=!0,this.audioNodeManager=new x(t),this.audioNodeManager.setInput(this._context.destination)}context(){return this._context}onError(){this._context.suspend()}async reloadContext(){this._context.resume()}async handleStream(t){this._context.resume(),this.sourceNode=this._context.createMediaStreamSource(t),this.audioNodeManager.setOutput(this.sourceNode)}getRecorderNode(){return this}};var K=class{logRange(t,e,i,o){if(i<=e)return e;let n=1,r=1000001,a=e<0&&i<0,l=a?e*-1+1:e<=0?-1*e+1:e+1,u=a?i*-1+1:e<=0?i+l:i+1,c=Math.log(l),p=(Math.log(u)-c)/(r-n);return o?(Math.log(t/(a?-1:1)+(a||e>0?1:l))-c)/p+n:(Math.exp(c+p*(t-n))-(a||e>0?1:l))*(a?-1:1)}getPositionForLogRangeValue(t,e,i){return this.logRange(t,e,i,!0)}exponentialValueInRange(t,e,i){return this.logRange(t,e,i)}};function ut(s){for(var t=s.split(/([#.])/),e="",i="",o=[],n=0;n<t.length;n++){var r=t[n];r==="#"?i=t[++n]:r==="."?o.push(t[++n]):r.length&&(e=r)}return{tag:e||"div",id:i,className:o.join(" ")}}function mt(s,t){var e=ut(s),i=e.tag,o=e.id,n=e.className,r=t?document.createElementNS(t,i):document.createElement(i);return o&&(r.id=o),n&&(t?r.setAttribute("class",n):r.className=n),r}function J(s,t){var e=E(s),i=E(t);return t===i&&i.__redom_view&&(t=i.__redom_view),i.parentNode&&(H(t,i,e),e.removeChild(i)),t}function H(s,t,e){var i=t.__redom_lifecycle;if(O(i)){t.__redom_lifecycle={};return}var o=e;for(t.__redom_mounted&&Q(t,"onunmount");o;){var n=o.__redom_lifecycle||{};for(var r in i)n[r]&&(n[r]-=i[r]);O(n)&&(o.__redom_lifecycle=null),o=o.parentNode}}function O(s){if(s==null)return!0;for(var t in s)if(s[t])return!1;return!0}var pt=["onmount","onremount","onunmount"],At=typeof window!="undefined"&&"ShadowRoot"in window;function d(s,t,e,i){var o=E(s),n=E(t);t===n&&n.__redom_view&&(t=n.__redom_view),t!==n&&(n.__redom_view=t);var r=n.__redom_mounted,a=n.parentNode;return r&&a!==o&&H(t,n,a),e!=null?i?o.replaceChild(n,E(e)):o.insertBefore(n,E(e)):o.appendChild(n),gt(t,n,o,a),t}function Q(s,t){t==="onmount"||t==="onremount"?s.__redom_mounted=!0:t==="onunmount"&&(s.__redom_mounted=!1);var e=s.__redom_lifecycle;if(!!e){var i=s.__redom_view,o=0;i&&i[t]&&i[t]();for(var n in e)n&&o++;if(o)for(var r=s.firstChild;r;){var a=r.nextSibling;Q(r,t),r=a}}}function gt(s,t,e,i){for(var o=t.__redom_lifecycle||(t.__redom_lifecycle={}),n=e===i,r=!1,a=0,l=pt;a<l.length;a+=1){var u=l[a];n||s!==t&&u in s&&(o[u]=(o[u]||0)+1),o[u]&&(r=!0)}if(!r){t.__redom_lifecycle={};return}var c=e,C=!1;for((n||c&&c.__redom_mounted)&&(Q(t,n?"onremount":"onmount"),C=!0);c;){var p=c.parentNode,v=c.__redom_lifecycle||(c.__redom_lifecycle={});for(var M in o)v[M]=(v[M]||0)+o[M];if(C)break;(c.nodeType===Node.DOCUMENT_NODE||At&&c instanceof ShadowRoot||p&&p.__redom_mounted)&&(Q(c,n?"onremount":"onmount"),C=!0),c=p}}function ft(s,t,e){var i=E(s);if(typeof t=="object")for(var o in t)X(i,o,t[o]);else X(i,t,e)}function X(s,t,e){e==null?s.style[t]="":s.style[t]=e}var P="http://www.w3.org/1999/xlink";function _(s,t,e,i){var o=E(s),n=typeof t=="object";if(n)for(var r in t)_(o,r,t[r],i);else{var a=o instanceof SVGElement,l=typeof e=="function";if(t==="style"&&typeof e=="object")ft(o,e);else if(a&&l)o[t]=e;else if(t==="dataset")tt(o,e);else if(!a&&(t in o||l)&&t!=="list")o[t]=e;else{if(a&&t==="xlink"){$(o,e);return}i&&t==="class"&&(e=o.className+" "+e),e==null?o.removeAttribute(t):o.setAttribute(t,e)}}}function $(s,t,e){if(typeof t=="object")for(var i in t)$(s,i,t[i]);else e!=null?s.setAttributeNS(P,t,e):s.removeAttributeNS(P,t,e)}function tt(s,t,e){if(typeof t=="object")for(var i in t)tt(s,i,t[i]);else e!=null?s.dataset[t]=e:delete s.dataset[t]}function Ct(s){return document.createTextNode(s??"")}function et(s,t,e){for(var i=0,o=t;i<o.length;i+=1){var n=o[i];if(!(n!==0&&!n)){var r=typeof n;r==="function"?n(s):r==="string"||r==="number"?s.appendChild(Ct(n)):U(E(n))?d(s,n):n.length?et(s,n,e):r==="object"&&_(s,n,null,e)}}}function Et(s){return typeof s=="string"?y(s):E(s)}function E(s){return s.nodeType&&s||!s.el&&s||E(s.el)}function U(s){return s&&s.nodeType}var st={};function y(s){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];var i,o=typeof s;if(o==="string")i=it(s).cloneNode(!1);else if(U(s))i=s.cloneNode(!1);else if(o==="function"){var n=s;i=new(Function.prototype.bind.apply(n,[null].concat(t)))}else throw new Error("At least one argument required");return et(E(i),t,!0),i}var m=y;y.extend=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var o=it(t);return y.bind.apply(y,[this,o].concat(e))};function it(s){return st[s]||(st[s]=mt(s))}function R(s){for(var t=[],e=arguments.length-1;e-- >0;)t[e]=arguments[e+1];for(var i=E(s),o=ot(s,t,i.firstChild);o;){var n=o.nextSibling;J(s,o),o=n}}function ot(s,t,e){for(var i=e,o=new Array(t.length),n=0;n<t.length;n++)o[n]=t[n]&&E(t[n]);for(var r=0;r<t.length;r++){var a=t[r];if(!!a){var l=o[r];if(l===i){i=i.nextSibling;continue}if(U(l)){var u=i&&i.nextSibling,c=a.__redom_index!=null,C=c&&u===o[r+1];d(s,a,i,C),C&&(i=u);continue}a.length!=null&&(i=ot(s,a,i))}}return i}var nt=function(t,e,i){this.View=t,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],e!=null&&(this.key=typeof e=="function"?e:Mt(e))};nt.prototype.update=function(t,e){for(var i=this,o=i.View,n=i.key,r=i.initData,a=n!=null,l=this.lookup,u={},c=new Array(t.length),C=this.views,p=0;p<t.length;p++){var v=t[p],M=void 0;if(a){var I=n(v);M=l[I]||new o(r,v,p,t),u[I]=M,M.__redom_id=I}else M=C[p]||new o(r,v,p,t);M.update&&M.update(v,p,t,e);var ct=E(M.el);ct.__redom_view=M,c[p]=M}this.oldViews=C,this.views=c,this.oldLookup=l,this.lookup=u};function Mt(s){return function(t){return t[s]}}var W=function(t,e,i,o){this.View=e,this.initData=o,this.views=[],this.pool=new nt(e,i,o),this.el=Et(t),this.keySet=i!=null};W.prototype.update=function(t,e){t===void 0&&(t=[]);var i=this,o=i.keySet,n=this.views;this.pool.update(t,e);var r=this.pool,a=r.views,l=r.lookup;if(o)for(var u=0;u<n.length;u++){var c=n[u],C=c.__redom_id;l[C]==null&&(c.__redom_index=null,J(this,c))}for(var p=0;p<a.length;p++){var v=a[p];v.__redom_index=p}R(this,a),o&&(this.lookup=l),this.views=a};W.extend=function(t,e,i,o){return W.bind(W,t,e,i,o)};var rt;(function(s){s[s.playing=0]="playing",s[s.selected=1]="selected",s[s.playingAndHover=2]="playingAndHover",s[s.playingAndSelected=3]="playingAndSelected",s[s.hover=4]="hover",s[s.idle=5]="idle"})(rt||(rt={}));var L=class{constructor(t,e,i){this.id=t,this.handler=e,this.img=i,this.el=m("div.sampleSelect"),this.isSampleEntity=!0,this.handleClick=this.handleClick.bind(this),this.renderCanvas=this.renderCanvas.bind(this),this.toggleHover=this.toggleHover.bind(this),this.elements={},this.selectedID=void 0}handleClick(t){t!==this.selectedID&&this.handler.onSampleSelected(t)}toggleHover(t){switch(this.elements[t].state){case 4:this.elements[t].state=5,this.renderCanvas(t);return;case 2:this.elements[t].state=0;return;case 5:this.elements[t].state=4,this.renderCanvas(t);return;case 0:this.elements[t].state=2;return;default:return}}renderCanvas(t,e){let{canvas:i,context:o,state:n,pattern:r,offset:a,previous:l}=this.elements[t];switch(n){case 5:o.filter="",i.style.opacity="0";return;case 1:o.filter="hue-rotate(250deg) saturate(110%) opacity(38%)",i.style.opacity="1",o.clearRect(0,0,i.width,i.height),o.fillStyle=r,o.fillRect(0,0,i.width,1200);return;case 4:o.filter="";break;case 0:o.filter="hue-rotate(150deg) saturate(120%) opacity(40%)";break;case 2:o.filter="hue-rotate(80deg) saturate(120%) opacity(40%)";break;case 3:o.filter="hue-rotate(250deg) saturate(150%) opacity(40%)";break}i.style.opacity="1",o.clearRect(0,0,i.width,i.height),o.save(),o.fillStyle=r,a>0&&(o.save(),o.translate(0,a-1200),o.fillRect(0,0,i.width,1200),o.restore()),o.translate(0,a),o.fillRect(0,0,i.width,1200),o.translate(0,a),o.restore();let u=e??performance.now();this.elements[t].offset=a>=1200?0:l===0?a+1:a+(u-l)*.08,this.elements[t].previous=u,requestAnimationFrame(c=>this.renderCanvas(t,c))}onSampleStateChanged(t,e){switch(e){case g.paused:this.elements[t].wrap.classList.remove("playing"),this.elements[t].state=this.elements[t].state===3?1:5;break;case g.playing:this.elements[t].wrap.classList.add("playing"),this.elements[t].state=this.elements[t].state===1?3:0;break}this.renderCanvas(t)}onSampleSelectedChanged(t){if(this.selectedID){this.elements[this.selectedID].wrap.classList.remove("selected");let e=this.elements[this.selectedID].state===1;this.elements[this.selectedID].state=e?5:0,e&&this.renderCanvas(this.selectedID)}this.elements[t].wrap.classList.add("selected"),this.selectedID=t,this.elements[t].state=this.elements[t].state===0?3:1,this.renderCanvas(t)}onSampleNodeValueChange(){}onSampleError(t){}onSampleCreated(t){if(this.elements[t])throw Error(`Select list already contains sample ${t}`);let e=m("div.sampleItem"),i=m("span",`Sample ${new Date().toUTCString()}`),o=m("p");d(o,i),d(e,o);let n=m("canvas"),r=n.getContext("2d");if(!r)throw Error(`No canvas context for selector for ${t}`);e.addEventListener("click",l=>{l.preventDefault(),this.handleClick(t)}),e.addEventListener("mouseenter",()=>this.toggleHover(t)),e.addEventListener("mouseleave",()=>this.toggleHover(t)),r.save(),n.width=400,n.height=1200,r.drawImage(this.img.mushImg(),0,0,n.width,n.height);let a=r.createPattern(n,"repeat");if(!a)throw Error(`No pattern for selector for ${t}`);r.restore(),this.elements[t]={wrap:e,canvas:n,context:r,pattern:a,state:5,offset:0,previous:0},d(this.el,e),n.width=e.clientWidth,d(e,n)}};var at;(function(s){s[s.idle=0]="idle",s[s.start=1]="start",s[s.holding=2]="holding"})(at||(at={}));var S;(function(s){s[s.tap=0]="tap",s[s.hold=1]="hold"})(S||(S={}));var N=class{constructor(t,e,i=0,o){if(this.handler=t,this._stateLabels=e,this.buttonCTA=i,!(o in this._stateLabels))throw Error("Initial state not available state");let n=Object.keys(this._stateLabels).map(a=>a.length).sort().reverse()[0];this.stateLabels=Object.entries(this._stateLabels).reduce((a,[l,u])=>(a[l]=u.padEnd(n),a),{}),this.state=o,this.touchTimeout=0,this.touchState=0,this.touchHold=this.touchHold.bind(this),this.el=m("div",{className:"labelButton",style:{maxWidth:`${Math.min(n,32)}ch`}});let r=m("p");this.label=m("span",this.stateLabels[o]),d(r,this.label),d(this.el,r),this.button=m("button"),this.setButtonText(),d(this.el,this.button),this.onDown=this.onDown.bind(this),this.button.addEventListener("mousedown",this.onDown),this.touchStart=this.touchStart.bind(this),this.button.addEventListener("touchstart",this.touchStart),this.touchEnd=this.touchEnd.bind(this),this.button.addEventListener("touchend",this.touchEnd),this.onUp=this.onUp.bind(this),this.button.addEventListener("mouseup",this.onUp),this.onClick=this.onClick.bind(this),this.button.addEventListener("click",this.onClick),this.onLeave=this.onLeave.bind(this),this.button.addEventListener("mouseleave",this.onLeave)}setButtonText(t){switch(t!==void 0&&(this.buttonCTA=t),this.buttonCTA){case 0:this.button.textContent="Tap here";break;case 1:this.button.textContent="Hold here";break}}touchEnd(t){t.preventDefault(),t.stopPropagation(),clearTimeout(this.touchTimeout),this.touchState===2&&this.buttonCTA===1?this.onUp():(this.touchState=0,this.onClick())}touchHold(){this.onDown()}touchStart(t){t.preventDefault(),t.stopPropagation(),this.touchState===0&&(this.touchState=1,this.touchTimeout=window.setTimeout(this.touchHold,100))}onUp(t){t?.preventDefault(),this.touchState=0,this.el.classList.remove("down"),this.buttonCTA!==0&&this.handler.onUp?.(this.state)}onClick(t){t?.preventDefault(),this.buttonCTA===0&&this.handler.onClick?.(this.state)}onDown(t){t?.preventDefault(),this.touchState=2,this.el.classList.add("down"),this.buttonCTA!==0&&this.handler.onDown?.(this.state)}onLeave(t){t?.preventDefault(),this.touchState===2&&this.el.classList.remove("down"),this.buttonCTA===1&&this.handler.onLeave?.(this.state)}setState(t){if(!(t in this.stateLabels))throw Error("Setting unavailable button state");this.state=t,this.label.textContent=this.stateLabels[this.state]}setCTA(t){this.setButtonText(t)}enable(){this.button.disabled=!1}disable(){this.button.disabled=!0}};var w;(function(s){s.paused="Play sample",s.playing="Pause sample"})(w||(w={}));var j=class{constructor(t,e){this.sampleID=t,this.handler=e,this.el=new N(this,Object.values(w).reduce((i,o)=>Object.assign(i,{[o]:o}),{}),S.tap,w.paused),this.onClick=this.onClick.bind(this)}onClick(){this.handler.onToggleSamplePlaying(this.sampleID)}onStateChange(t){switch(t){case g.paused:this.el.setState(w.paused);break;case g.playing:this.el.setState(w.playing);break}}};var ht;(function(s){s[s.locked=0]="locked",s[s.idle=1]="idle",s[s.down=2]="down",s[s.slide=3]="slide",s[s.released=4]="released"})(ht||(ht={}));var b=class{constructor(t,e,i,o,n,r=1){this.id=t,this.type=e,this.handler=i,this.imgProvider=o,this.value=r,this.el=m("div.rangeChange"),this.isResizeEntity=!0;let a=m("p");this.labelEl=m("span",n),d(a,this.labelEl),d(this.el,a),this.canvas=m("canvas");let l=this.canvas.getContext("2d");if(!l)throw Error(`No canvas context for ui range node ${this.type}`);this.context2D=l,d(this.el,this.canvas),this.context2D.font='57px "Courier New", Courier, monospace',this.leftArrows="\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039\u2039",this.rightArrows="\u203A\u203A\u203A\u203A\u203A\u203A\u203A\u203A\u203A";let u=this.context2D.measureText(this.leftArrows);this.arrowWidth=u.width,this.arrowHeight=u.actualBoundingBoxAscent,this.increment=0,this.minIncrement=1,this.maxIncrement=1e4,this.maxValue=1000001,this.minValue=1,this.startX=0,this.state=1,this.onDown=this.onDown.bind(this),this.onUp=this.onUp.bind(this),this.onDrag=this.onDrag.bind(this),this.updateValue=this.updateValue.bind(this),this.handleUp=this.handleUp.bind(this),this.setValue=this.setValue.bind(this),this.flipflop=this.flipflop.bind(this),this.renderCanvas=this.renderCanvas.bind(this),this.setCanvasSize=this.setCanvasSize.bind(this),this.onResize=this.onResize.bind(this),this.setCanvasEvents(),this.renderCanvas()}setCanvasSize(){this.canvas.width=this.el.clientWidth,this.canvas.height=96,this.renderCanvas()}handleUp(){window.removeEventListener("mouseup",this.handleUp),window.removeEventListener("touchend",this.handleUp),this.onUp()}setCanvasEvents(){this.canvas.addEventListener("mousedown",t=>{window.addEventListener("mouseup",this.handleUp),window.addEventListener("touchend",this.handleUp),this.onDown(t.clientX)}),this.canvas.addEventListener("touchstart",t=>{window.addEventListener("mouseup",this.handleUp),window.addEventListener("touchend",this.handleUp),this.onDown(t.touches[0].clientX)}),this.canvas.addEventListener("mousemove",t=>{t.preventDefault(),t.stopPropagation(),this.onDrag(t.clientX)}),this.canvas.addEventListener("touchmove",t=>{t.preventDefault(),t.stopPropagation(),this.onDrag(t.touches[0].clientX)})}onDown(t){this.state===1&&(this.state=2,this.startX=t)}onUp(){this.state=this.state===3?4:1,this.increment=0,this.startX=0,this.renderCanvas()}onDrag(t){if(this.state===2&&(this.state=3,this.updateValue()),this.state!==3)return;let{width:e}=this.canvas;if(t>e||t<0)return;let i=this.startX<t?1:this.startX>t?-1:0;if(i===0){this.increment=0;return}let o=e*.5,n=i===-1?this.startX<o?this.startX/o*(this.maxIncrement+this.minIncrement):this.maxIncrement+this.minIncrement:this.startX>o?(e-this.startX)/o*(this.maxIncrement+this.minIncrement):this.maxIncrement+this.minIncrement,r=i===-1?(t-this.startX)/this.startX:(t-this.startX)/(e-this.startX);this.increment=r*n-this.minIncrement}flipflop(){requestAnimationFrame(this.updateValue)}updateValue(){if(this.state===4){this.state=1;return}if(this.state!==3)throw Error("Range update occuring during invalid state");this.handler.onUIRangeChange(this.type,Math.max(Math.min(this.value+this.increment,this.maxValue),this.minValue)),this.renderCanvas(),requestAnimationFrame(this.flipflop)}renderCanvas(){this.context2D.clearRect(0,0,this.canvas.width,this.canvas.height),this.context2D.globalAlpha=100/255,this.context2D.fillStyle="#000000",this.context2D.fillRect(0,30,this.canvas.width,this.canvas.height-30);let t=this.canvas.width*.01,e=this.increment/this.maxIncrement*(t*15),i=this.canvas.width*.2,o=[i*2,i,i*2];this.context2D.drawImage(this.imgProvider.handImg(),o[0]+o[1]*.5-38*.5+e,this.canvas.height-38),this.context2D.font='57px "Courier New", Courier, monospace',this.context2D.fillStyle="#8c9daa";let n=(this.canvas.height-30)*.5+this.arrowHeight*.5+30;this.context2D.fillText(this.leftArrows,o[0]-this.arrowWidth+e,n),this.context2D.font='57px "Courier New", Courier, monospace',this.context2D.fillStyle="#8c9daa",this.context2D.fillText(this.rightArrows,o[0]+o[1]+e,n),this.context2D.globalAlpha=1,this.context2D.fillStyle="#0a0a0a",this.context2D.fillRect(0,0,this.canvas.width,30),this.context2D.font='18px "Courier New", Courier, monospace',this.context2D.fillStyle="#8c9daa",this.context2D.fillText(`${this.value}`,0,22)}update(){this.renderCanvas()}setValue(t){this.value=t}onResize(){this.setCanvasSize()}};var lt;(function(s){s[s.visible=0]="visible",s[s.hidden=1]="hidden"})(lt||(lt={}));var T=class{constructor(t,e,i,o,n,r){this.id=t,this.sampleID=e,this.handler=i,this.el=m("div.hidden"),this.isSampleEntity=!0,this.playBtn=new j(e,this.handler),this.volumeCtrl=new b(o.createID(),A.volume,this,r,"Slide to control volume",500001),o.addEntity(this.volumeCtrl),this.lowpassCtrl=new b(o.createID(),A.lowpass,this,r,"Slide to control filter"),o.addEntity(this.lowpassCtrl),this.distortionCtrl=new b(o.createID(),A.distortion,this,r,"Slide to control distortion"),o.addEntity(this.distortionCtrl),this.compressorCtrl=new b(o.createID(),A.compressor,this,r,"Slide to control compressor"),o.addEntity(this.compressorCtrl),this.speedCtrl=new b(o.createID(),A.speed,this,r,"Slide to control speed",n.getPositionForLogRangeValue(1,.1,3)),o.addEntity(this.speedCtrl),d(this.el,this.playBtn),d(this.el,this.compressorCtrl),d(this.el,this.distortionCtrl),d(this.el,this.lowpassCtrl),d(this.el,this.volumeCtrl),d(this.el,this.speedCtrl),this.state=1}show(){this.state!==0&&(this.state=0,this.el.classList.remove("hidden"),this.compressorCtrl.onResize(),this.distortionCtrl.onResize(),this.lowpassCtrl.onResize(),this.speedCtrl.onResize(),this.volumeCtrl.onResize())}hide(){this.state!==1&&(this.state=1,this.el.classList.add("hidden"))}onUIRangeChange(t,e){this.handler.onSampleControlChange(this.sampleID,t,e)}onSampleStateChanged(t,e){t===this.sampleID&&this.playBtn.onStateChange(e)}onSampleNodeValueChange(t,e,i){if(t===this.sampleID)switch(e){case A.compressor:this.compressorCtrl.setValue(i);break;case A.distortion:this.distortionCtrl.setValue(i);break;case A.lowpass:this.lowpassCtrl.setValue(i);break;case A.speed:this.speedCtrl.setValue(i);break;case A.volume:this.volumeCtrl.setValue(i);break}}onSampleSelectedChanged(t){this.state===0&&this.sampleID!==t&&this.hide(),this.state===1&&this.sampleID===t&&this.show()}onSampleError(t){}onSampleCreated(){}loadHand(){this.compressorCtrl.update(),this.distortionCtrl.update(),this.lowpassCtrl.update(),this.speedCtrl.update(),this.volumeCtrl.update()}};var f;(function(s){s.error="Reload context",s.noDevice="Enable input device",s.requestingDevice="Loading...",s.idle="Hold down to record",s.stopRecording="Stopping...",s.recording="Release to stop recording",s.startRecording="Starting..."})(f||(f={}));var z=class{constructor(t,e,i){this.id=t,this.handler=e,this.recordLength=i,this.el=new N(this,Object.values(f).reduce((o,n)=>Object.assign(o,{[n]:n}),{}),S.tap,f.noDevice),this.isRecordingEntity=!0,this.stopRecording=this.stopRecording.bind(this),this.onDown=this.onDown.bind(this),this.onUp=this.onUp.bind(this),this.onLeave=this.onLeave.bind(this),this.onClick=this.onClick.bind(this),this.recordingTimeout=0}stopRecording(){clearTimeout(this.recordingTimeout),this.handler.recordButtonOnStop()}onDown(t){t===f.idle&&this.handler.recordButtonOnStart()}onUp(t){t===f.recording&&this.stopRecording()}onLeave(t){t===f.recording&&this.stopRecording()}onClick(t){switch(t){case f.error:this.handler.recordButtonOnReload();break;case f.noDevice:this.handler.recordButtonOnRequest();break;default:break}}onRecordingStateChanged(t){switch(t){case h.starting:this.el.disable(),this.el.setState(f.startRecording);break;case h.recording:this.el.setState(f.recording),this.el.enable(),this.recordingTimeout=window.setTimeout(this.stopRecording,this.recordLength*1e3);break;case h.closing:this.el.disable(),this.el.setState(f.stopRecording);break;case h.idle:this.el.setState(f.idle),this.el.enable(),this.el.setCTA(S.hold);break;case h.noDevice:this.el.setState(f.noDevice),this.el.setCTA(S.tap);break;case h.error:this.el.setState(f.error);break;case h.requestingDevice:this.el.disable(),this.el.setState(f.requestingDevice);break}}onRecordingError(){this.el.setState(f.error)}};var D=class{constructor(t){this.handler=t,this.mush="data:image/jpeg;base64,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",this.hand="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAQAAAACNCElAAACgklEQVRIx82WS0iUURTH/6MyzWhgZY6LYCIbFMVHYWUQBD0hbBFWC3tZA2ktSpMWBTUF0fTYBNKmoo2LkISihRBEC7OFpE3tXEQPKMceRpQlPXT+nXu/mXFmyuab75tF/8PAHO7lN+eee+45AySrAj2l9NIhhk6UwIbWYqScvXzJQd7gYuIZFlmHbQNbaOgBfQRRaR3WCDbzu4Z94UoFq7AF28WfGjaSDdgOTmjYa66zD9vHiIYNs8Y+bA9/aNgo67IR2ZSGfeDybMAmNewNl9mHtUfr7AWXZiMyI2fjXG0ftp8xbVSwGjgRwHltx5Ere5zazMFao6VBblCw9wg3sonb1XdiEG0Ia+tGE8rTwnZHnxMlRiereSfq9fE2PXRJUV9jlZiHOIPT6NO2fqjqT1jD9AUoVcvjmoh7n1nLVXEvyBwWcqF8VMybGAoy14Dkw6/tcjJsi2x7FfeeSzSf4t43HuReWR1jgHNkn+/cFTfgxgCeOlhpZCUJFpauNh73vvJuwtovXuDNaIFvlSjB+yGgAJzHW/JLV3mIeTzAREWYXlPsZIHABq5rmDe+0MsuZqpRnlWwSJkc04VHHoZoXffkYmRirIFDpb8QLLUB0w2hLVYQHkj6rUs3hKIYrARSL0P2IvPGYLPQCilQaxrjEnXI/OnKL4bwrWmzSn7SdC1Gv4t+C6jHRtdLma55ODqXJ2SWf8wI1qBQHZid+siL0IVIDo9kBNOtqfbvLagF7MgA9UQN6ofwzfTH5a2X3SZvMcj5xDvUzdwemzFZz34TsIA6YA/K/tVr3dLxedEsbGe6OXAYvGQCdkrB/Olg7f8z7CSPsT7BViR5hr/ALMy0pcB+A9RSdD00vbpEAAAAAElFTkSuQmCC",this.mushImgEl=new Image(600,600),this.mushImgEl.onload=this.handler.onMushImageLoaded,this.mushImgEl.src=this.mush,this.handImgEl=new Image(38,38),this.handImgEl.onload=this.handler.onHandImageLoaded,this.handImgEl.src=this.hand}mushImgStr(){return this.mush}handImgStr(){return this.hand}mushImg(){return this.mushImgEl}handImg(){return this.handImgEl}};var G=class{constructor(t,e,i,o,n,r,a,l){this.id=t,this.handler=e,this.sampleHandler=i,this.mathUtility=o;let u=this.getElOrThrow(n);this.addStylesheet(l);let c=m("div.schallvernichtung");this.baseEl=m("div.base"),this.bg=m("canvas.bg");let C=this.bg.getContext("2d");if(!C)throw Error("No background context");this.bgContext=C,this.onMushImageLoaded=this.onMushImageLoaded.bind(this),this.onHandImageLoaded=this.onHandImageLoaded.bind(this),this.images=new D(this),d(u,c),R(c,[this.bg,this.baseEl]),this.sampleBlocks=[],this.samplesMount=m("div.samplesMount"),this.sampleList=new L(this.handler.createID(),i,this.images),this.handler.addEntity(this.sampleList),this.recordBtn=new z(this.handler.createID(),r,a),this.handler.addEntity(this.recordBtn),this.isSampleEntity=!0,this.setUI()}addStylesheet(t){let e=this.getElOrThrow("head"),i=m("link",{type:"text/css",rel:"stylesheet",href:t});e.appendChild(i)}getElOrThrow(t){let e=document.querySelector(t);if(!e)throw Error(`Couldn't find element ${t}`);return e}wrap(t,e,i){let o=m(`div${i?`.${i}`:""}`);if(e){let n=m("p",e);d(o,n)}return Array.isArray(t)?R(o,t):d(o,t),o}setUI(){d(this.baseEl,this.wrap([this.recordBtn],void 0,"topLevel")),d(this.baseEl,this.wrap([this.samplesMount,this.sampleList],void 0,"sampleManager"))}drawBg(){this.bgContext.drawImage(this.images.mushImg(),0,0,this.bg.width*.5,this.bg.height),this.bgContext.drawImage(this.images.mushImg(),this.bg.width*.5,0,this.bg.width*.5,this.bg.height)}onSampleCreated(t){let e=new T(this.handler.createID(),t,this.sampleHandler,this.handler,this.mathUtility,this.images);this.handler.addEntity(e),this.sampleBlocks.push(e),d(this.samplesMount,e)}onSampleStateChanged(t,e,i){}onSampleSelectedChanged(t){this.baseEl.scrollTo(0,0)}onSampleNodeValueChange(){}onSampleError(t){}onMushImageLoaded(){this.drawBg()}onHandImageLoaded(){for(let t of this.sampleBlocks)t.loadHand()}};var Y=class{constructor(t){this.core=t,this.debounceCount=0,this.debounceTimeout=0,this.emit=this.emit.bind(this),this.debounceEmit=this.debounceEmit.bind(this),window.addEventListener("resize",this.debounceEmit)}isResizeEntity(t){return"isResizeEntity"in t&&t.isResizeEntity}debounceEmit(){clearTimeout(this.debounceTimeout),this.debounceCount>=10&&(this.debounceCount=0,this.emit()),this.debounceCount+=1,this.debounceTimeout=window.setTimeout(this.emit,100)}emit(){for(let t=0;t<this.core.entities().length;t++){let e=this.core.entities()[t];this.isResizeEntity(e)&&e.onResize(window.innerWidth,window.innerHeight)}}};var dt=class{constructor(t,e,i){let o=10,n=4096;this.contextNodeID="context",this.contextNode=new B(this.contextNodeID),this._entities=[],this.recordingHandler=new Z(this,this.contextNode,e,n,o),this.sampleHandler=new V(this),this.resizeHandler=new Y(this),this.mathUtility=new K,this.ui=new G(this.createID(),this,this.sampleHandler,this.mathUtility,t,this.recordingHandler,o,i),this.addEntity(this.ui)}addEntity(t){this._entities.push(t)}createID(){return q(10)}entities(){return this._entities}onRecorded(t){if(t.length<this.contextNode.context().sampleRate*.2)return;let e=this.createID(),i=new k(e,this.contextNode,this.mathUtility,t);this.addEntity(i),i.audioNodeManager.connectOutput(this.contextNode),this.sampleHandler.onSampleCreated(e)}};export{dt as Schallvernichtung};
